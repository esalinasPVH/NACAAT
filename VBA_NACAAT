Sub Assign_WorksheetData_Name()
'
' AssignTableName Macro
'
    Dim tbl As ListObject
    Dim rng As Range
    
    Set rng = Range("A2", Range("AW2").End(xlDown))
    
    ActiveSheet.Range("A2", Range("AW2").End(xlDown)).Select
    ActiveWorkbook.Names.Add name:="Table_NA_Comm_Wksht", RefersTo:=Selection

    
End Sub

Sub Export()

    Dim dt As String
    dt = Format(Now, "yyyymmdd-HHmmss")
    
    Sheets("NA Commercialization Worksheet").Activate
    
    Assign_WorksheetData_Name
    
    ActiveWorkbook.Connections("Query - Query_NA_Export").Refresh
    
    Dim ver As String
    ver = Range("CurrentVersion").Cells(1, 1)
    
    Dim cv As String
    cv = Range("CollectionValue").Cells(1, 1)
    
    Dim FilePath, FileOnly, PathOnly As String
    FilePath = ThisWorkbook.FullName
    FileOnly = ThisWorkbook.name
    PathOnly = Left(FilePath, Len(FilePath) - Len(FileOnly))
    
    Dim nm As String
    nm = PathOnly & "NACAAT-" & cv & "-MDM-" & ver & "_" & dt & ".xlsx"
    
    Worksheets("Sheet_NA_Export").Visible = xlSheetVisible
    Sheets("Sheet_NA_Export").Activate
    ActiveSheet.Copy
    ActiveWorkbook.SaveAs Filename:=nm, _
    FileFormat:=xlWorkbookDefault
    ActiveWindow.Close
    
    Sheets("Sheet_NA_Export").Activate
    Worksheets("Sheet_NA_Export").Visible = xlSheetHidden
    
    Sheets("Instructions").Activate
    
    MsgBox ("Export complete! Close NACAAT and locate file for MDM upload.")
    
End Sub


Sub Initialize()
'
' Initialize NACAAT
'

' NA Commercialization Worksheet
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    ActiveSheet.Cells(1, 2).Value = ""
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetHidden
    
'Clear query ranges
    Range("Query_NAFlat_CARtlEcom").ClearContents
    Range("Query_NAFlat_CARtlEcom_DS").ClearContents
    Range("Query_NAFlat_CARtlOut").ClearContents
    Range("Query_NAFlat_CARtlOut_DS").ClearContents
    Range("Query_NAFlat_CAWhs").ClearContents
    Range("Query_NAFlat_IM").ClearContents
    Range("Query_NAFlat_USRtlEcom").ClearContents
    Range("Query_NAFlat_USRtlEcom_DS").ClearContents
    Range("Query_NAFlat_USRtlOut").ClearContents
    Range("Query_NAFlat_USRtlOut_DS").ClearContents
    Range("Query_NAFlat_USWhs").ClearContents

'Reset to Instructions view
    Sheets("Instructions").Activate
    MsgBox ("Initialization complete!")
    
End Sub

Sub Load_CARtlEcom()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_CARtlEcom").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_CARtlEcom").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "Canada Tommy Hilfiger Retail Ecom"
    ActiveSheet.Cells(1, 3).Value = "CNTHRE"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_CARtlEcom_DS()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_CARtlEcom_DS").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_CARtlEcom_DS").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "Canada Tommy Hilfiger Retail Ecom"
    ActiveSheet.Cells(1, 3).Value = "CNTHRE"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_CARtlOut()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_CARtlOut").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_CARtlOut").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "Canada Tommy Hilfiger Retail Outlet"
    ActiveSheet.Cells(1, 3).Value = "CNTHRO"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_CARtlOut_DS()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_CARtlOut_DS").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_CARtlOut_DS").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "Canada Tommy Hilfiger Retail Outlet"
    ActiveSheet.Cells(1, 3).Value = "CNTHRO"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_CAWhs()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_CAWhs").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_CAWhs").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "Canada Tommy Hilfiger Wholesale"
    ActiveSheet.Cells(1, 3).Value = "CNTHWH"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_IM()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_IM").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_IM").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "US Tommy Hilfiger Wholesale (IM)"
    ActiveSheet.Cells(1, 3).Value = "IM"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_USRtlEcom()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_USRtlEcom").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_USRtlEcom").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "US Tommy Hilfiger Retail Ecom"
    ActiveSheet.Cells(1, 3).Value = "USTHRE"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_USRtlEcom_DS()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_USRtlEcom_DS").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_USRtlEcom_DS").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "US Tommy Hilfiger Retail Ecom"
    ActiveSheet.Cells(1, 3).Value = "USTHRE"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_USRtlOut()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_USRtlOut").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_USRtlOut").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "US Tommy Hilfiger Retail Outlet"
    ActiveSheet.Cells(1, 3).Value = "USTHRO"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

Sub Load_USRtlOut_DS()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_USRtlOut_DS").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_USRtlOut_DS").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "US Tommy Hilfiger Retail Outlet"
    ActiveSheet.Cells(1, 3).Value = "USTHRO"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub


Sub Load_USWhs()
'
' Load data from named query range into NA Commercialization worksheet
'
    ActiveWorkbook.Connections("Query - Query_NAFlat_USWhs").Refresh
    
    Worksheets("NA Commercialization Worksheet").Visible = xlSheetVisible
    Sheets("NA Commercialization Worksheet").Activate
    Rows("3:" & Rows.Count).ClearContents
    
    Range("Query_NAFlat_USWhs").Copy
    Sheets("NA Commercialization Worksheet").Cells(3, 2).PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    
    Sheets("NA Commercialization Worksheet").Cells.EntireRow.AutoFit
    Sheets("NA Commercialization Worksheet").Columns("A").ColumnWidth = 10.57
    Sheets("NA Commercialization Worksheet").Rows("1").RowHeight = 23.25
  
    ActiveSheet.Cells(1, 2).Value = "US Tommy Hilfiger Wholesale"
    ActiveSheet.Cells(1, 3).Value = "USTHWH"
    ActiveSheet.Cells(3, 1).Select
    
    MsgBox ("Data load complete!")
    
End Sub

